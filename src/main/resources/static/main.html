<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Signin</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/signin.css" rel="stylesheet">
    <script src="bootstrap/js/jquery-3.2.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container">

    <form class="form-signin" id="form">
        <h2 class="form-signin-heading">Please sign in</h2>
        <label for="username" class="sr-only">Username</label>
        <input type="text" id="username" class="form-control" name="username" placeholder="Usernaem" required autofocus>
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" id="inputPassword" class="form-control" name="password" placeholder="Password" required>
        <label for="logintype" class="sr-only">login identify</label>
        <select id="logintype" name="logintype" class="form-control" required>
            <option>Student</option>
            <option>Teacher</option>
        </select>
        <a  id="login" href="javascript:void(0)" class="btn btn-lg btn-primary btn-block">Sign in</a>
    </form>

</div>
<script>
    $(function () {
        var $login = $("#login");
        $login.bind("click",function () {
            var username = $("#username").val();
            var password = $("#inputPassword").val();
            var logintype = $("#logintype").val();
            var loginJson = {
                "username":username,
                "password":password,
                "logintype":logintype,
            }
            $.ajax({
                type : "post",
                url : "/login",
                data :JSON.stringify(loginJson),
                contentType : "application/json;charset=utf-8",
                dataType:"json",
                success:function (commResult) {
                   if (commResult.resultCode == 0 && logintype=="Student"){
                       var studentinfo = commResult.data;
                       studentinfo = JSON.stringify(studentinfo);

                       sessionStorage.setItem("student",studentinfo);

//                       alert(sessionStorage.getItem("student"));
                       window.location.href="http://localhost:8081/student/stuMain.html";
                   }else if (commResult.resultCode == 0 && logintype=="Teacher"){
                       sessionStorage.setItem("teacher",commResult.data);
                       window.location.href="http://127.0.0.1:8081/teacher/teaMain.html";
                   }
                },
                error:function (commResult) {
                    sessionStorage.setItem("loginerror",commResult.resultMsg);
                   window.location.href="http://127.0.0.1:8081/main.html";
                }
            })
        })
    })

</script>
</body>
</html>
